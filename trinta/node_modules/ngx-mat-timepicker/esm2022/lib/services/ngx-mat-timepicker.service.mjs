import { Injectable } from "@angular/core";
import { NgxMatTimepickerPeriods } from "../models/ngx-mat-timepicker-periods.enum";
import { NgxMatTimepickerAdapter } from "./ngx-mat-timepicker-adapter";
//
import { BehaviorSubject } from "rxjs";
import * as i0 from "@angular/core";
const DEFAULT_HOUR = {
    time: 12,
    angle: 360
};
const DEFAULT_MINUTE = {
    time: 0,
    angle: 360
};
export class NgxMatTimepickerService {
    constructor() {
        this._hour$ = new BehaviorSubject(DEFAULT_HOUR);
        this._minute$ = new BehaviorSubject(DEFAULT_MINUTE);
        this._period$ = new BehaviorSubject(NgxMatTimepickerPeriods.AM);
    }
    set hour(hour) {
        this._hour$.next(hour);
    }
    set minute(minute) {
        this._minute$.next(minute);
    }
    set period(period) {
        const isPeriodValid = (period === NgxMatTimepickerPeriods.AM) || (period === NgxMatTimepickerPeriods.PM);
        if (isPeriodValid) {
            this._period$.next(period);
        }
    }
    get selectedHour() {
        return this._hour$.asObservable();
    }
    get selectedMinute() {
        return this._minute$.asObservable();
    }
    get selectedPeriod() {
        return this._period$.asObservable();
    }
    getFullTime(format) {
        const selectedHour = this._hour$.getValue().time;
        const selectedMinute = this._minute$.getValue().time;
        const hour = selectedHour != null ? selectedHour : DEFAULT_HOUR.time;
        const minute = selectedMinute != null ? selectedMinute : DEFAULT_MINUTE.time;
        const period = format === 12 ? this._period$.getValue() : "";
        const time = `${hour}:${minute} ${period}`.trim();
        return NgxMatTimepickerAdapter.formatTime(time, { format });
    }
    setDefaultTimeIfAvailable(time, min, max, format, minutesGap) {
        time || this._resetTime();
        /* Workaround to double error message*/
        try {
            if (NgxMatTimepickerAdapter.isTimeAvailable(time, min, max, "minutes", minutesGap)) {
                this._setDefaultTime(time, format);
            }
        }
        catch (e) {
            console.error(e);
        }
    }
    _resetTime() {
        this.hour = { ...DEFAULT_HOUR };
        this.minute = { ...DEFAULT_MINUTE };
        this.period = NgxMatTimepickerPeriods.AM;
    }
    _setDefaultTime(time, format) {
        const defaultDto = NgxMatTimepickerAdapter.parseTime(time, { format });
        if (defaultDto.isValid) {
            const period = time.substring(time.length - 2).toUpperCase();
            const hour = defaultDto.hour;
            this.hour = { ...DEFAULT_HOUR, time: formatHourByPeriod(hour, period) };
            this.minute = { ...DEFAULT_MINUTE, time: defaultDto.minute };
            this.period = period;
        }
        else {
            this._resetTime();
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.2.4", ngImport: i0, type: NgxMatTimepickerService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "17.2.4", ngImport: i0, type: NgxMatTimepickerService, providedIn: "root" }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.2.4", ngImport: i0, type: NgxMatTimepickerService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: "root"
                }]
        }] });
/***
 *  Format hour in 24hours format to meridian (AM or PM) format
 */
function formatHourByPeriod(hour, period) {
    switch (period) {
        case NgxMatTimepickerPeriods.AM:
            return hour === 0 ? 12 : hour;
        case NgxMatTimepickerPeriods.PM:
            return hour === 12 ? 12 : hour - 12;
        default:
            return hour;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LW1hdC10aW1lcGlja2VyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtbWF0LXRpbWVwaWNrZXIvc3JjL2xpYi9zZXJ2aWNlcy9uZ3gtbWF0LXRpbWVwaWNrZXIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBR3pDLE9BQU8sRUFBQyx1QkFBdUIsRUFBQyxNQUFNLDJDQUEyQyxDQUFDO0FBQ2xGLE9BQU8sRUFBQyx1QkFBdUIsRUFBQyxNQUFNLDhCQUE4QixDQUFDO0FBQ3JFLEVBQUU7QUFDRixPQUFPLEVBQUMsZUFBZSxFQUFhLE1BQU0sTUFBTSxDQUFDOztBQUdqRCxNQUFNLFlBQVksR0FBOEI7SUFDNUMsSUFBSSxFQUFFLEVBQUU7SUFDUixLQUFLLEVBQUUsR0FBRztDQUNiLENBQUM7QUFDRixNQUFNLGNBQWMsR0FBOEI7SUFDOUMsSUFBSSxFQUFFLENBQUM7SUFDUCxLQUFLLEVBQUUsR0FBRztDQUNiLENBQUM7QUFLRixNQUFNLE9BQU8sdUJBQXVCO0lBSHBDO1FBa0NZLFdBQU0sR0FBRyxJQUFJLGVBQWUsQ0FBNEIsWUFBWSxDQUFDLENBQUM7UUFDdEUsYUFBUSxHQUFHLElBQUksZUFBZSxDQUE0QixjQUFjLENBQUMsQ0FBQztRQUMxRSxhQUFRLEdBQUcsSUFBSSxlQUFlLENBQTBCLHVCQUF1QixDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBaUQvRjtJQS9FRyxJQUFJLElBQUksQ0FBQyxJQUErQjtRQUNwQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQsSUFBSSxNQUFNLENBQUMsTUFBaUM7UUFDeEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVELElBQUksTUFB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QUksQ0FBQztZQUU3QixJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUMsR0FBRyxZQUFZLEVBQUUsSUFBSSxFQUFFLGtCQUFrQixDQUFDLElBQUksRUFBRSxNQUFpQyxDQUFDLEVBQUMsQ0FBQztZQUNqRyxJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUMsR0FBRyxjQUFjLEVBQUUsSUFBSSxFQUFFLFVBQVUsQ0FBQyxNQUFNLEVBQUMsQ0FBQztZQUMzRCxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQWlDLENBQUM7U0FFbkQ7YUFDSTtZQUNELElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztTQUNyQjtJQUNMLENBQUM7OEdBakZRLHVCQUF1QjtrSEFBdkIsdUJBQXVCLGNBRnBCLE1BQU07OzJGQUVULHVCQUF1QjtrQkFIbkMsVUFBVTttQkFBQztvQkFDUixVQUFVLEVBQUUsTUFBTTtpQkFDckI7O0FBcUZEOztHQUVHO0FBQ0gsU0FBUyxrQkFBa0IsQ0FBQyxJQUFZLEVBQUUsTUFBK0I7SUFDckUsUUFBUSxNQUFNLEVBQUU7UUFDWixLQUFLLHVCQUF1QixDQUFDLEVBQUU7WUFDM0IsT0FBTyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUNsQyxLQUFLLHVCQUF1QixDQUFDLEVBQUU7WUFDM0IsT0FBTyxJQUFJLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7UUFDeEM7WUFDSSxPQUFPLElBQUksQ0FBQztLQUNuQjtBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdGFibGV9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbi8vXHJcbmltcG9ydCB7Tmd4TWF0VGltZXBpY2tlckNsb2NrRmFjZX0gZnJvbSBcIi4uL21vZGVscy9uZ3gtbWF0LXRpbWVwaWNrZXItY2xvY2stZmFjZS5pbnRlcmZhY2VcIjtcclxuaW1wb3J0IHtOZ3hNYXRUaW1lcGlja2VyUGVyaW9kc30gZnJvbSBcIi4uL21vZGVscy9uZ3gtbWF0LXRpbWVwaWNrZXItcGVyaW9kcy5lbnVtXCI7XHJcbmltcG9ydCB7Tmd4TWF0VGltZXBpY2tlckFkYXB0ZXJ9IGZyb20gXCIuL25neC1tYXQtdGltZXBpY2tlci1hZGFwdGVyXCI7XHJcbi8vXHJcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQge0RhdGVUaW1lfSBmcm9tIFwidHMtbHV4b25cIjtcclxuXHJcbmNvbnN0IERFRkFVTFRfSE9VUjogTmd4TWF0VGltZXBpY2tlckNsb2NrRmFjZSA9IHtcclxuICAgIHRpbWU6IDEyLFxyXG4gICAgYW5nbGU6IDM2MFxyXG59O1xyXG5jb25zdCBERUZBVUxUX01JTlVURTogTmd4TWF0VGltZXBpY2tlckNsb2NrRmFjZSA9IHtcclxuICAgIHRpbWU6IDAsXHJcbiAgICBhbmdsZTogMzYwXHJcbn07XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgICBwcm92aWRlZEluOiBcInJvb3RcIlxyXG59KVxyXG5leHBvcnQgY2xhc3MgTmd4TWF0VGltZXBpY2tlclNlcnZpY2Uge1xyXG5cclxuXHJcbiAgICBzZXQgaG91cihob3VyOiBOZ3hNYXRUaW1lcGlja2VyQ2xvY2tGYWNlKSB7XHJcbiAgICAgICAgdGhpcy5faG91ciQubmV4dChob3VyKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgbWludXRlKG1pbnV0ZTogTmd4TWF0VGltZXBpY2tlckNsb2NrRmFjZSkge1xyXG4gICAgICAgIHRoaXMuX21pbnV0ZSQubmV4dChtaW51dGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBwZXJpb2QocGVyaW9kOiBOZ3hNYXRUaW1lcGlja2VyUGVyaW9kcykge1xyXG4gICAgICAgIGNvbnN0IGlzUGVyaW9kVmFsaWQgPSAocGVyaW9kID09PSBOZ3hNYXRUaW1lcGlja2VyUGVyaW9kcy5BTSkgfHwgKHBlcmlvZCA9PT0gTmd4TWF0VGltZXBpY2tlclBlcmlvZHMuUE0pO1xyXG5cclxuICAgICAgICBpZiAoaXNQZXJpb2RWYWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9wZXJpb2QkLm5leHQocGVyaW9kKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHNlbGVjdGVkSG91cigpOiBPYnNlcnZhYmxlPE5neE1hdFRpbWVwaWNrZXJDbG9ja0ZhY2U+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faG91ciQuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHNlbGVjdGVkTWludXRlKCk6IE9ic2VydmFibGU8Tmd4TWF0VGltZXBpY2tlckNsb2NrRmFjZT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9taW51dGUkLmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzZWxlY3RlZFBlcmlvZCgpOiBPYnNlcnZhYmxlPE5neE1hdFRpbWVwaWNrZXJQZXJpb2RzPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BlcmlvZCQuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfaG91ciQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PE5neE1hdFRpbWVwaWNrZXJDbG9ja0ZhY2U+KERFRkFVTFRfSE9VUik7XHJcbiAgICBwcml2YXRlIF9taW51dGUkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxOZ3hNYXRUaW1lcGlja2VyQ2xvY2tGYWNlPihERUZBVUxUX01JTlVURSk7XHJcbiAgICBwcml2YXRlIF9wZXJpb2QkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxOZ3hNYXRUaW1lcGlja2VyUGVyaW9kcz4oTmd4TWF0VGltZXBpY2tlclBlcmlvZHMuQU0pO1xyXG5cclxuICAgIGdldEZ1bGxUaW1lKGZvcm1hdDogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZEhvdXIgPSB0aGlzLl9ob3VyJC5nZXRWYWx1ZSgpLnRpbWU7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRNaW51dGUgPSB0aGlzLl9taW51dGUkLmdldFZhbHVlKCkudGltZTtcclxuICAgICAgICBjb25zdCBob3VyID0gc2VsZWN0ZWRIb3VyICE9IG51bGwgPyBzZWxlY3RlZEhvdXIgOiBERUZBVUxUX0hPVVIudGltZTtcclxuICAgICAgICBjb25zdCBtaW51dGUgPSBzZWxlY3RlZE1pbnV0ZSAhPSBudWxsID8gc2VsZWN0ZWRNaW51dGUgOiBERUZBVUxUX01JTlVURS50aW1lO1xyXG4gICAgICAgIGNvbnN0IHBlcmlvZCA9IGZvcm1hdCA9PT0gMTIgPyB0aGlzLl9wZXJpb2QkLmdldFZhbHVlKCkgOiBcIlwiO1xyXG4gICAgICAgIGNvbnN0IHRpbWUgPSBgJHtob3VyfToke21pbnV0ZX0gJHtwZXJpb2R9YC50cmltKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBOZ3hNYXRUaW1lcGlja2VyQWRhcHRlci5mb3JtYXRUaW1lKHRpbWUsIHtmb3JtYXR9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgc2V0RGVmYXVsdFRpbWVJZkF2YWlsYWJsZSh0aW1lOiBzdHJpbmcsIG1pbjogRGF0ZVRpbWUsIG1heDogRGF0ZVRpbWUsIGZvcm1hdDogbnVtYmVyLCBtaW51dGVzR2FwPzogbnVtYmVyKSB7XHJcbiAgICAgICAgdGltZSB8fCB0aGlzLl9yZXNldFRpbWUoKTtcclxuICAgICAgICAvKiBXb3JrYXJvdW5kIHRvIGRvdWJsZSBlcnJvciBtZXNzYWdlKi9cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoTmd4TWF0VGltZXBpY2tlckFkYXB0ZXIuaXNUaW1lQXZhaWxhYmxlKHRpbWUsIG1pbiwgbWF4LCBcIm1pbnV0ZXNcIiwgbWludXRlc0dhcCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldERlZmF1bHRUaW1lKHRpbWUsIGZvcm1hdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfcmVzZXRUaW1lKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaG91ciA9IHsuLi5ERUZBVUxUX0hPVVJ9O1xyXG4gICAgICAgIHRoaXMubWludXRlID0gey4uLkRFRkFVTFRfTUlOVVRFfTtcclxuICAgICAgICB0aGlzLnBlcmlvZCA9IE5neE1hdFRpbWVwaWNrZXJQZXJpb2RzLkFNO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3NldERlZmF1bHRUaW1lKHRpbWU6IHN0cmluZywgZm9ybWF0OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBkZWZhdWx0RHRvID0gTmd4TWF0VGltZXBpY2tlckFkYXB0ZXIucGFyc2VUaW1lKHRpbWUsIHtmb3JtYXR9KTtcclxuXHJcbiAgICAgICAgaWYgKGRlZmF1bHREdG8uaXNWYWxpZCkge1xyXG4gICAgICAgICAgICBjb25zdCBwZXJpb2QgPSB0aW1lLnN1YnN0cmluZyh0aW1lLmxlbmd0aCAtIDIpLnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGhvdXIgPSBkZWZhdWx0RHRvLmhvdXI7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmhvdXIgPSB7Li4uREVGQVVMVF9IT1VSLCB0aW1lOiBmb3JtYXRIb3VyQnlQZXJpb2QoaG91ciwgcGVyaW9kIGFzIE5neE1hdFRpbWVwaWNrZXJQZXJpb2RzKX07XHJcbiAgICAgICAgICAgIHRoaXMubWludXRlID0gey4uLkRFRkFVTFRfTUlOVVRFLCB0aW1lOiBkZWZhdWx0RHRvLm1pbnV0ZX07XHJcbiAgICAgICAgICAgIHRoaXMucGVyaW9kID0gcGVyaW9kIGFzIE5neE1hdFRpbWVwaWNrZXJQZXJpb2RzO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0VGltZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLyoqKlxyXG4gKiAgRm9ybWF0IGhvdXIgaW4gMjRob3VycyBmb3JtYXQgdG8gbWVyaWRpYW4gKEFNIG9yIFBNKSBmb3JtYXRcclxuICovXHJcbmZ1bmN0aW9uIGZvcm1hdEhvdXJCeVBlcmlvZChob3VyOiBudW1iZXIsIHBlcmlvZDogTmd4TWF0VGltZXBpY2tlclBlcmlvZHMpOiBudW1iZXIge1xyXG4gICAgc3dpdGNoIChwZXJpb2QpIHtcclxuICAgICAgICBjYXNlIE5neE1hdFRpbWVwaWNrZXJQZXJpb2RzLkFNOlxyXG4gICAgICAgICAgICByZXR1cm4gaG91ciA9PT0gMCA/IDEyIDogaG91cjtcclxuICAgICAgICBjYXNlIE5neE1hdFRpbWVwaWNrZXJQZXJpb2RzLlBNOlxyXG4gICAgICAgICAgICByZXR1cm4gaG91ciA9PT0gMTIgPyAxMiA6IGhvdXIgLSAxMjtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gaG91cjtcclxuICAgIH1cclxufVxyXG4iXX0=